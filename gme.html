<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Number Game — Step-by-step</title>
    <style>
        body {
            background-color: #fff;
            color: #c00;
            text-align: center;
            font-family: Arial, sans-serif;
            padding-top: 40px;
        }
        input {
            padding: 10px;
            font-size: 16px;
            width: 80px;
            text-align: center;
            border-radius: 6px;
            border: 1px solid #ddd;
        }
        button {
            margin-top: 16px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #c00;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 8px;
        }
        button.secondary {
            background: #eee;
            color: #333;
            margin-left: 8px;
        }
        .instructions {
            font-size: 18px;
            margin-top: 24px;
            color: #444;
        }
        .result {
            font-size: 24px;
            margin-top: 20px;
            color: #c00;
            font-weight: bold;
        }
    </style>
</head>
<body>

<h2>Enter a number between 1 and 100</h2>
<input type="number" id="num" min="1" max="100" placeholder="e.g. 27">
<button id="startBtn">Start</button>
<button id="resetBtn" class="secondary" style="display:none">Reset</button>

<div class="instructions" id="instructionArea" style="display:none"></div>
<div>
    <button id="nextBtn" style="display:none">Next</button>
</div>

<div id="final" class="result"></div>

<script>
(function() {
    const numInput = document.getElementById('num');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const instructionArea = document.getElementById('instructionArea');
    const nextBtn = document.getElementById('nextBtn');
    const finalDiv = document.getElementById('final');

    let chosen, randomNum, stepIndex, steps;

    function prepareSteps() {
        steps = [
            'Step 1 — Multiply your number by 2',
            `Step 2 — Add ${randomNum}`,
            'Step 3 — Divide the result by 2',
            'Step 4 — Subtract your original number'
        ];
    }

    function startGame() {
        finalDiv.textContent = '';
        chosen = parseInt(numInput.value, 10);
        if (isNaN(chosen) || chosen < 1 || chosen > 100) {
            alert('Please enter a valid number between 1 and 100');
            return;
        }

        randomNum = Math.floor(Math.random() * 100) + 1;
        prepareSteps();

        instructionArea.style.display = 'block';
        nextBtn.style.display = 'inline-block';
        resetBtn.style.display = 'inline-block';
        startBtn.disabled = true;
        numInput.disabled = true;

        stepIndex = 0;
        showStep();
    }

    function showStep() {
        instructionArea.innerHTML = `<strong>${steps[stepIndex]}</strong>`;
        if (stepIndex === steps.length - 1) {
            nextBtn.textContent = 'Finish';
        } else {
            nextBtn.textContent = 'Next';
        }
    }

    function onNext() {
        if (stepIndex < steps.length - 1) {
            stepIndex++;
            showStep();
        } else {
            finalDiv.innerHTML = `The number in your mind is: ${(randomNum / 2).toFixed(2)}`;
            nextBtn.textContent = 'Restart';
            nextBtn.setAttribute('data-restart', 'true');
        }
    }

    function resetGame() {
        startBtn.disabled = false;
        numInput.disabled = false;
        nextBtn.style.display = 'none';
        resetBtn.style.display = 'none';
        instructionArea.style.display = 'none';
        finalDiv.textContent = '';
        nextBtn.textContent = 'Next';
        nextBtn.removeAttribute('data-restart');
        stepIndex = 0;
    }

    startBtn.addEventListener('click', startGame);
    nextBtn.addEventListener('click', function() {
        if (nextBtn.getAttribute('data-restart') === 'true') {
            resetGame();
        } else {
            onNext();
        }
    });
    resetBtn.addEventListener('click', resetGame);

    numInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') startGame();
    });
})();
</script>

</body>
</html>
